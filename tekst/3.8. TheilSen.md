### Regresja Theil-Sena

Regresja Theil-Sena to metoda statystyczna stosowana do szacowania nachylenia liniowej trendu między dwiema zmiennymi. Jest ona szczególnie skuteczna w przypadku występowania anomalii/wartości odstających.

#### Główne cechy
Regresja Theil-Sena jest mniej wrażliwa na wartości odstające w porównaniu do zwykłej regresji liniowej. 

Nachylenie linii regresji jest określane poprzez obliczenie nachyleń między wszystkimi parami punktów danych, a następnie wzięcie mediany tych nachyleń. 
Po oszacowaniu nachylenia, przecięcie można obliczyć, używając mediany reszt lub dowolnego punktu na dopasowanej linii.

To podejście, zamiast polegać na średniej, zapewnia bardziej stabilną ocenę, gdy występują wartości odstające.

#### Wzory ogólne
Dla zbioru danych z $n$ obserwacji, nachylenie $m$ oblicza się w następujący sposób:

$$
m = \text{median}\left(\frac{y_j - y_i}{x_j - x_i}\right) \quad \text{for all } i < j
$$

gdzie $(x_i, y_i)$ i $(x_j, y_j)$ są parami obserwacji.

Po określeniu nachylenia, przecięcie $b$ można obliczyć za pomocą:

$$
b = \text{median}(y_i - m x_i)
$$


Ostateczne (uproszczone) równanie linii regresji Theil-Sena można wyrazić jako:

$$
y = mx + b
$$

#### Zalety
- Regresja Theil-Sena zapewnia wiarygodne oszacowania nawet wtedy, gdy dane zawierają wartości odstające.
- łatwo zinterpretować (jest to poniekąd regresja liniowa która jest dopasowana z pominięciem anomalii).

#### Ograniczenia
Głównym wyzwaniem dla estymatora Theil-Sena jest jego $O(n^2)$ złożoność wynikająca z obliczania nachyleń między wszystkimi parami punktów. Istnieją jednak bardziej wydajne metody, osiągające $O(n \log n)$ złożoność czasową przy użyciu deterministycznych lub losowych algorytmów. W modelach wykorzystujących operacje na bitach,  możliwe są jeszcze szybsze implementacje z losowym oczekiwanym czasem $O(n \sqrt {\log n})$.

Podobnie jak inne metody regresji liniowej, Theil-Sen zakłada liniową zależność między zmiennymi, co może czynić ten model nie elastycznym.

#### Zastosowania
Model Theil-Sena jest stosowany w różnych dziedzinach ze względu na jego odporność na wartości odstające oraz wartości 'cenzorowane' (astronomia). W biofizyce jest stosowany do oszacowania powierzchni liści. Jest preferowany w przypadku sezonowych danych środowiskowych, takich jak jakość wody, ze względu na precyzję w przypadku asymetrycznych(skewed) danych. W informatyce pomaga identyfikować trendy starzenia się oprogramowania, a w meteorologii ocenia długoterminowe trendy wiatru.


#### Użyte parametry dla GridSearchCV
- max_iter: definiuje maksymalną liczbę iteracji algorytmu optymalizacji.
- max_subpopulation: określa maksymalną liczbę podzbiorów używanych w procesie dopasowania.
- fit_intercept: parametr logiczny. wskazuje czy obliczyć przecięcie dla tego modelu.
- tol: ustawia tolerancję dla kryteriów zatrzymania w procesie optymalizacji.


Bibliografia:

[1] https://blogs.sas.com/content/iml/2019/05/28/theil-sen-robust-regression.html

[2] https://www.prepvector.com/blog/theilsen-regression-and-estimator

[3] https://scikit-learn.org/stable/modules/grid_search.html

[4] https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.TheilSenRegressor.html

[5] Akritas, Michael G.; Murphy, Susan A.; LaValley, Michael P. (1995), "The Theil-Sen estimator with doubly censored data and applications to astronomy", Journal of the American Statistical Association, 90 (429): 170–177, doi:10.1080/01621459.1995.10476499, JSTOR 2291140, MR 1325124.

[6] Hirsch, Robert M.; Slack, James R.; Smith, Richard A. (1982), "Techniques of trend analysis for monthly water quality data", Water Resources Research, 18 (1): 107–121, Bibcode:1982WRR....18..107H, doi:10.1029/WR018i001p00107.

[7] Vaidyanathan, Kalyanaraman; Trivedi, Kishor S. (2005), "A Comprehensive Model for Software Rejuvenation", IEEE Transactions on Dependable and Secure Computing, 2 (2): 124–137, doi:10.1109/TDSC.2005.15, S2CID 15105513.

[8] Romanić, Djordje; Ćurić, Mladjen; Jovičić, Ilija; Lompar, Miloš (2014), "Long-term trends of the 'Koshava' wind during the period 1949–2010", International Journal of Climatology, 35 (2): 288–302, Bibcode:2015IJCli..35..288R, doi:10.1002/joc.3981, S2CID 129402302.

[9] Fernandes, Richard; Leblanc, Sylvain G. (2005), "Parametric (modified least squares) and non-parametric (Theil–Sen) linear regressions for predicting biophysical parameters in the presence of measurement errors", Remote Sensing of Environment, 95 (3): 303–316, Bibcode:2005RSEnv..95..303F, doi:10.1016/j.rse.2005.01.005.

[10] Chan, Timothy M.; Pătraşcu, Mihai (2010), "Counting inversions, offline orthogonal range counting, and related problems", Proceedings of the Twenty-First Annual ACM-SIAM Symposium on Discrete Algorithms (SODA '10), pp. 161–173, doi:10.1137/1.9781611973075.15.

[11] Cole, Richard; Salowe, Jeffrey S.; Steiger, W. L.; Szemerédi, Endre (1989), "An optimal-time algorithm for slope selection", SIAM Journal on Computing, 18 (4): 792–810, doi:10.1137/0218055, MR 1004799.

[12] Blunck, Henrik; Vahrenhold, Jan (2006), "In-place randomized slope selection", International Symposium on Algorithms and Complexity, Lecture Notes in Computer Science, vol. 3998, Berlin: Springer-Verlag, pp. 30–41, doi:10.1007/11758471_6, ISBN 978-3-540-34375-2, MR 2263136.